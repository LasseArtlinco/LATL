<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LATL Frontend</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Allerta+Stencil&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style id="globalStyles">
        /* Global stilarter vil blive indsat her via JavaScript */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Open Sans', sans-serif;
            min-height: 100vh;
        }
        
        .latl-header {
            position: sticky;
            top: 0;
            z-index: 100;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .latl-logo {
            font-family: 'Allerta Stencil', sans-serif;
            font-size: 1.5rem;
            text-decoration: none;
            font-weight: bold;
        }
        
        .latl-nav {
            display: flex;
            gap: 1rem;
        }
        
        .latl-nav a {
            text-decoration: none;
            padding: 0.5rem;
        }
        
        .latl-footer {
            padding: 2rem 1rem;
            margin-top: 2rem;
        }
        
        .cookie-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
        }
        
        .cookie-banner button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .band {
            width: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }
        
        .band-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }
        
        .band.full-width .band-content {
            max-width: 100%;
            padding: 0;
        }
        
        /* Båndtyper */
        .band-slideshow {
            position: relative;
            overflow: hidden;
        }
        
        .slideshow-container {
            display: flex;
            transition: transform 0.5s ease-in-out;
            width: 100%;
            height: 100%;
        }
        
        .slideshow-slide {
            flex: 0 0 100%;
            height: 100%;
            background-position: center;
            background-size: cover;
            position: relative;
        }
        
        .slide-content {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            max-width: 1200px;
            width: 100%;
            padding: 0 2rem;
            box-sizing: border-box;
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
        }
        
        .slide-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0) 50%);
        }
        
        .slideshow-nav {
            position: absolute;
            bottom: 1rem;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .slideshow-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
        }
        
        .slideshow-dot.active {
            background-color: white;
        }
        
        .band-product {
            padding: 4rem 0;
        }
        
        .product-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }
        
        .product-card {
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            background-color: white;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .product-image-container {
            position: relative;
            width: 100%;
            height: 250px;
            overflow: hidden;
        }
        
        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .product-card:hover .product-image {
            transform: scale(1.05);
        }
        
        .product-info {
            padding: 1.5rem;
        }
        
        .product-title {
            margin-top: 0;
            margin-bottom: 0.5rem;
            font-size: 1.25rem;
        }
        
        .product-price {
            font-family: 'Allerta Stencil', sans-serif;
            font-size: 1.4rem;
            margin: 1rem 0;
            color: var(--primary-color);
        }
        
        .product-button {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            background-color: var(--accent-color);
            color: var(--primary-color);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s, transform 0.2s;
            text-align: center;
            text-decoration: none;
            width: 100%;
        }
        
        .product-button:hover {
            background-color: var(--bright-color);
            transform: translateY(-2px);
        }
        
        .band-html {
            padding: 4rem 0;
        }
        
        .band-html.bg-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .band-html.bg-secondary {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .band-html.bg-accent {
            background-color: var(--accent-color);
            color: var(--primary-color);
        }
        
        .band-html.bg-bright {
            background-color: var(--bright-color);
            color: var(--primary-color);
        }
        
        .band-link {
            padding: 4rem 0;
            text-align: center;
        }
        
        .band-link.bg-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .band-link.bg-secondary {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .band-link.bg-accent {
            background-color: var(--accent-color);
            color: var(--primary-color);
        }
        
        /* CSS for CTA bånd */
        .band-cta {
            padding: 3rem 0;
            text-align: center;
        }
        
        .band-cta.bg-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .band-cta.bg-secondary {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .band-cta.bg-accent {
            background-color: var(--accent-color);
            color: var(--primary-color);
        }
        
        .band-cta.bg-bright {
            background-color: var(--bright-color);
            color: var(--primary-color);
        }
        
        .cta-button {
            display: inline-block;
            padding: 1rem 2.5rem;
            font-size: 1.1rem;
            font-weight: bold;
            background-color: var(--accent-color);
            color: var(--primary-color);
            border-radius: 4px;
            text-decoration: none;
            transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
            margin-top: 1.5rem;
            border: none;
            cursor: pointer;
        }
        
        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            background-color: var(--bright-color);
        }
        
        .band-link.bg-bright {
            background-color: var(--bright-color);
            color: var(--primary-color);
        }
        
        .band-link h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .band-link p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto 2rem auto;
        }
        
        .band-link a {
            display: inline-block;
            padding: 1rem 2rem;
            border-radius: 4px;
            text-decoration: none;
            font-weight: 600;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .band-link a:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        @media (max-width: 768px) {
            .product-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="latl-header">
        <a href="/" class="latl-logo">LATL.dk</a>
        <nav class="latl-nav">
            <a href="/shop">Shop</a>
            <a href="/about">Om os</a>
            <a href="/contact">Kontakt</a>
            <a href="/cart">Kurv (0)</a>
        </nav>
    </header>
    
    <main id="page-content">
        <!-- Dynamisk indhold vil blive indsat her -->
        <div class="loading-container" style="display: flex; justify-content: center; align-items: center; height: 50vh;">
            <p>Indlæser indhold...</p>
        </div>
    </main>
    
    <footer class="latl-footer">
        <div class="band-content">
            <div class="footer-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem;">
                <div>
                    <h3>LATL.dk</h3>
                    <p>Håndlavede lædervarer og laserskæring i høj kvalitet.</p>
                </div>
                <div>
                    <h3>Kontakt</h3>
                    <p>Email: info@latl.dk</p>
                    <p>Telefon: +45 12345678</p>
                </div>
                <div>
                    <h3>Information</h3>
                    <p><a href="/about">Om os</a></p>
                    <p><a href="/terms">Handelsbetingelser</a></p>
                    <p><a href="/privacy">Privatlivspolitik</a></p>
                </div>
            </div>
            <div style="margin-top: 2rem; text-align: center;">
                <p>&copy; 2025 LATL.dk - Alle rettigheder forbeholdes</p>
                <button id="cookieSettingsButton" style="background: none; border: none; text-decoration: underline; cursor: pointer;">Cookie-indstillinger</button>
            </div>
        </div>
    </footer>
    
    <div id="cookieBanner" class="cookie-banner" style="display: none;">
        <div>
            <p>Vi bruger cookies for at forbedre din oplevelse på vores hjemmeside.</p>
        </div>
        <div>
            <button id="acceptCookiesButton">Acceptér</button>
            <button id="rejectCookiesButton">Afvis</button>
        </div>
    </div>
    
    <script>
        // Render CTA bånd
        function renderCtaBand(bandElement, band) {
            const content = band.band_content || {};
            
            const bandContent = document.createElement('div');
            bandContent.className = 'band-content';
            
            if (content.title) {
                const title = document.createElement('h2');
                title.textContent = content.title;
                title.style.fontSize = '2.5rem';
                title.style.marginBottom = '1rem';
                bandContent.appendChild(title);
            }
            
            if (content.description) {
                const description = document.createElement('p');
                description.textContent = content.description;
                description.style.fontSize = '1.2rem';
                description.style.maxWidth = '800px';
                description.style.margin = '0 auto 1.5rem auto';
                bandContent.appendChild(description);
            }
            
            if (content.button_link) {
                const button = document.createElement('a');
                button.href = content.button_link;
                button.textContent = content.button_text || 'Klik her';
                button.className = 'cta-button';
                
                // Tilføj speciel stil baseret på indstillinger
                if (content.button_color) {
                    button.style.backgroundColor = content.button_color;
                }
                
                if (content.button_text_color) {
                    button.style.color = content.button_text_color;
                }
                
                bandContent.appendChild(button);
            }
            
            bandElement.appendChild(bandContent);
        }
        
        // IMPORTANT: Use direct API endpoint path to avoid 404 on root API endpoint
        // Instead of just '/api' which fails with 404
        const API_BASE_URL = '/api';
        
        // Debug flag
        const DEBUG = true;
        let globalStyles = {};
        let currentPageId = null;
        
        // Hjælpefunktion til at hente data fra API
        async function fetchApi(endpoint) {
            try {
                // Build the full URL - don't try to check the base API
                const fullUrl = `${API_BASE_URL}/${endpoint}`;
                if (DEBUG) console.log(`Fetching from: ${fullUrl}`);
                
                const response = await fetch(fullUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP error ${response.status}`);
                }
                
                const result = await response.json();
                
                if (DEBUG) console.log('API response:', result);
                
                if (result.status !== 'success') {
                    throw new Error(result.message || 'API returned error status');
                }
                
                return result;
            } catch (error) {
                console.error('API Error:', error);
                
                // Show error on page if in debug mode
                if (DEBUG) {
                    const pageContent = document.getElementById('page-content');
                    pageContent.innerHTML = `
                        <div class="band-content" style="padding: 2rem 0;">
                            <h1>API Fejl</h1>
                            <p>Der opstod en fejl ved kommunikation med API'et:</p>
                            <pre style="background: #f1f1f1; padding: 1rem; overflow: auto;">${error.toString()}</pre>
                            <p>Endpoint: ${API_BASE_URL}/${endpoint}</p>
                            <p>Kontrollér at:</p>
                            <ul>
                                <li>API'et kører og er tilgængeligt</li>
                                <li>Endpoint stien er korrekt</li>
                                <li>CORS-headers er korrekt konfigureret</li>
                            </ul>
                            <p>Fejlmeddelelse: Side ikke fundet eller API-fejl</p>
                        </div>
                    `;
                    
                    // Offer to load mock data
                    pageContent.innerHTML += `
                        <div class="band-content" style="padding: 2rem 0; text-align: center; border-top: 1px solid #ddd; margin-top: 2rem;">
                            <h2>Debug Værktøjer</h2>
                            <p>Kan ikke forbinde til API'et. Vil du indlæse mock data for at teste layout?</p>
                            <button id="loadMockData" style="padding: 0.5rem 1rem; background-color: #333; color: white; border: none; border-radius: 4px; cursor: pointer;">Indlæs Mock Data</button>
                        </div>
                    `;
                    
                    document.getElementById('loadMockData').addEventListener('click', loadMockData);
                }
                
                return null;
            }
        }
        
        // Skip trying to load global styles from a dedicated endpoint
        // and set reasonable defaults immediately
        function setDefaultStyles() {
            const cssVars = `
                :root {
                    --primary-color: #042940;
                    --secondary-color: #005C53;
                    --accent-color: #9FC131;
                    --bright-color: #DBF227;
                    --background-color: #D6D58E;
                    --text-color: #042940;
                }
                
                body {
                    background-color: var(--background-color);
                    color: var(--text-color);
                }
                
                .latl-header {
                    background-color: var(--primary-color);
                    color: white;
                }
                
                .latl-logo {
                    color: white;
                }
                
                .latl-nav a {
                    color: white;
                }
                
                .latl-footer {
                    background-color: var(--secondary-color);
                    color: white;
                }
                
                .latl-footer a {
                    color: var(--bright-color);
                }
                
                .band-link a {
                    background-color: var(--accent-color);
                    color: var(--primary-color);
                }
                
                .band-link a:hover {
                    background-color: var(--bright-color);
                }
                
                .cookie-banner button {
                    background-color: var(--accent-color);
                    color: var(--primary-color);
                }
            `;
            
            // Apply CSS
            document.getElementById('globalStyles').textContent += cssVars;
        }
        
        // Load page layout
        async function loadPage(pageId) {
            currentPageId = pageId || 'forside'; // Default to front page
            
            if (DEBUG) console.log(`Loading page: ${currentPageId}`);
            
            const result = await fetchApi(`layout/${currentPageId}`);
            
            if (result && result.status === 'success' && result.data) {
                // Success! Render the page with data
                renderPage(result.data);
            } else {
                // API call failed or page not found
                showErrorPage('Side ikke fundet eller API-fejl');
            }
        }
        
        // Show error page
        function showErrorPage(errorMessage) {
            const pageContent = document.getElementById('page-content');
            pageContent.innerHTML = `
                <div class="band-content" style="padding: 2rem 0; text-align: center;">
                    <h1>Side ikke fundet</h1>
                    <p>Beklager, men den ønskede side kunne ikke findes.</p>
                    <p>Dette kan skyldes at:</p>
                    <ul style="list-style: none; padding: 0;">
                        <li>Siden ikke eksisterer</li>
                        <li>API'et ikke er tilgængeligt</li>
                        <li>Der er problemer med forbindelsen til API'et</li>
                    </ul>
                    <p>Fejlmeddelelse: ${errorMessage}</p>
                    <a href="/" class="button" style="display: inline-block; padding: 0.5rem 1rem; background-color: var(--accent-color); color: var(--primary-color); text-decoration: none; border-radius: 4px; margin-top: 1rem;">Gå til forsiden</a>
                </div>
            `;
            
            // If we can't reach the API, offer to load mock data
            if (DEBUG) {
                pageContent.innerHTML += `
                    <div class="band-content" style="padding: 2rem 0; text-align: center; border-top: 1px solid #ddd; margin-top: 2rem;">
                        <h2>Debug Værktøjer</h2>
                        <p>Kan ikke forbinde til API'et. Vil du indlæse mock data for at teste layout?</p>
                        <button id="loadMockData" style="padding: 0.5rem 1rem; background-color: #333; color: white; border: none; border-radius: 4px; cursor: pointer;">Indlæs Mock Data</button>
                    </div>
                `;
                
                document.getElementById('loadMockData').addEventListener('click', loadMockData);
            }
        }
        
        // Mock data for testing
        function loadMockData() {
            const mockLayout = {
                page_id: "forside",
                layout_data: {
                    title: "LATL.dk - Læder og Laserskæring",
                    meta_description: "Håndlavede lædervarer og laserskæring i høj kvalitet fra LATL.dk."
                },
                bands: [
                    {
                        id: 1,
                        layout_id: 1,
                        band_type: "slideshow",
                        band_height: 3,
                        band_order: 1,
                        band_content: {
                            full_width: true,
                            slides: [
                                {
                                    image: "https://images.unsplash.com/photo-1605030753481-64d14b4d4251?q=80&w=1974&auto=format&fit=crop",
                                    title: "Håndlavede lædervarer",
                                    description: "Unikke og holdbare produkter lavet med omhu og kærlighed til håndværket.",
                                    link: "/shop",
                                    link_text: "Se vores udvalg"
                                },
                                {
                                    image: "https://images.unsplash.com/photo-1551717551-7d5f490d201f?q=80&w=2070&auto=format&fit=crop",
                                    title: "Laserskæring i højeste kvalitet",
                                    description: "Præcision og detaljer, der gør hvert produkt unikt og personligt.",
                                    link: "/custom",
                                    link_text: "Design dit eget produkt"
                                }
                            ]
                        }
                    },
                    {
                        id: 2,
                        layout_id: 1,
                        band_type: "html",
                        band_height: 1,
                        band_order: 2,
                        band_content: {
                            background_class: "bg-primary",
                            align: "center",
                            padding: "3rem 1rem",
                            html: "<h2 style='color: white; font-size: 2.2rem; margin-bottom: 1.5rem;'>Velkommen til LATL.dk</h2><p style='color: white; max-width: 800px; margin: 0 auto; font-size: 1.1rem;'>Vi specialiserer os i håndlavede lædervarer og laserskæring af højeste kvalitet. Hvert produkt er skabt med omhu, præcision og kærlighed til håndværket.</p>"
                        }
                    },
                    {
                        id: 3,
                        layout_id: 1,
                        band_type: "product",
                        band_height: 2,
                        band_order: 3,
                        band_content: {
                            title: "Udvalgte produkter",
                            description: "Se vores mest populære håndlavede lædervarer",
                            products: [
                                {
                                    title: "Læder Pung",
                                    description: "Håndlavet pung i førsteklasses læder. Holdbar og elegant med plads til kort og sedler.",
                                    price: 599,
                                    image: "https://images.unsplash.com/photo-1627123424574-724758594e93?q=80&w=1974&auto=format&fit=crop"
                                },
                                {
                                    title: "Nøglering med monogram",
                                    description: "Personlig nøglering i læder med dit valgte monogram laserskåret i materialet.",
                                    price: 249,
                                    image: "https://images.unsplash.com/photo-1626871550973-99d0644f8b12?q=80&w=1974&auto=format&fit=crop"
                                }
                            ]
                        }
                    }
                ]
            };
            
            renderPage(mockLayout);
        }
        
        // Render a page based on layout data
        function renderPage(layoutData) {
            const pageContent = document.getElementById('page-content');
            pageContent.innerHTML = ''; // Clear existing content
            
            if (DEBUG) console.log('Rendering page with data:', layoutData);
            
            // IMPORTANT: Based on API test, we know bands are directly in 'bands' property
            const bands = layoutData.bands || [];
            
            if (DEBUG) {
                console.log('Found bands:', {
                    bandsCount: bands.length,
                    firstBand: bands.length > 0 ? bands[0] : null
                });
            }
            
            if (bands.length > 0) {
                // Sort bands by band_order
                bands.sort((a, b) => a.band_order - b.band_order);
                
                // Render each band
                bands.forEach(band => {
                    try {
                        const bandElement = renderBand(band);
                        if (bandElement) {
                            pageContent.appendChild(bandElement);
                        }
                    } catch (error) {
                        console.error('Error rendering band:', error, band);
                        
                        // Show error info if in debug mode
                        if (DEBUG) {
                            const errorDiv = document.createElement('div');
                            errorDiv.className = 'band-content';
                            errorDiv.style.padding = '1rem';
                            errorDiv.style.backgroundColor = '#ffeeee';
                            errorDiv.style.border = '1px solid #ffcccc';
                            errorDiv.style.margin = '1rem 0';
                            errorDiv.innerHTML = `
                                <h3>Fejl ved rendering af bånd</h3>
                                <p>${error.message}</p>
                                <pre>${JSON.stringify(band, null, 2)}</pre>
                            `;
                            pageContent.appendChild(errorDiv);
                        }
                    }
                });
            } else {
                // No bands found
                pageContent.innerHTML = `
                    <div class="band-content" style="padding: 2rem 0; text-align: center;">
                        <h1>Ingen bånd fundet</h1>
                        <p>Der blev ikke fundet nogen bånd til denne side.</p>
                        <p>Data modtaget fra API:</p>
                        <pre style="text-align: left; background: #f5f5f5; padding: 1rem; max-height: 300px; overflow: auto; margin-top: 1rem; font-size: 12px;">${JSON.stringify(layoutData, null, 2)}</pre>
                    </div>
                `;
            }
        }
        
        // Render a single band
        function renderBand(band) {
            if (DEBUG) console.log('Rendering band:', band);
            
            const bandElement = document.createElement('div');
            bandElement.className = `band band-${band.band_type}`;
            
            const content = band.band_content || {};
            
            // Add extra classes based on settings
            if (content.full_width === true) {
                bandElement.classList.add('full-width');
            }
            
            if (content.background_color) {
                bandElement.style.backgroundColor = content.background_color;
            }
            
            if (content.text_color) {
                bandElement.style.color = content.text_color;
            }
            
            if (content.background_class) {
                bandElement.classList.add(content.background_class);
            }
            
            // Calculate height based on band_height (1x, 2x, 3x, 4x)
            const baseHeight = 300; // Base height in pixels
            const height = band.band_height * baseHeight;
            
            // For slideshow we always use a fixed height
            if (band.band_type === 'slideshow') {
                bandElement.style.height = `${height}px`;
            } else {
                bandElement.style.minHeight = `${height}px`;
            }
            
            // Render different content based on band type
            switch (band.band_type) {
                case 'slideshow':
                    renderSlideshowBand(bandElement, band);
                    break;
                    
                case 'product':
                case 'product_card':
                case 'product_full':
                    renderProductBand(bandElement, band);
                    break;
                    
                case 'html':
                    renderHtmlBand(bandElement, band);
                    break;
                    
                case 'related_products':
                    renderRelatedProductsBand(bandElement, band);
                    break;
                    
                case 'link':
                    renderLinkBand(bandElement, band);
                    break;
                    
                case 'cta':
                    renderCtaBand(bandElement, band);
                    break;
                    
                default:
                    const contentElement = document.createElement('div');
                    contentElement.className = 'band-content';
                    contentElement.innerHTML = `<p>Ukendt båndtype: ${band.band_type}</p>`;
                    bandElement.appendChild(contentElement);
            }
            
            return bandElement;
        }
        
        // Render slideshow band
        function renderSlideshowBand(bandElement, band) {
            const content = band.band_content || {};
            const slides = content.slides || [];
            
            if (slides.length === 0) {
                const emptyContent = document.createElement('div');
                emptyContent.className = 'band-content';
                emptyContent.innerHTML = `
                    <p>Ingen slides fundet for dette slideshow.</p>
                `;
                bandElement.appendChild(emptyContent);
                return;
            }
            
            const slideshowContainer = document.createElement('div');
            slideshowContainer.className = 'slideshow-container';
            
            slides.forEach((slide, index) => {
                const slideElement = document.createElement('div');
                slideElement.className = 'slideshow-slide';
                slideElement.style.backgroundImage = `url('${slide.image}')`;
                
                // Add overlay for better readability
                const overlay = document.createElement('div');
                overlay.className = 'slide-overlay';
                slideElement.appendChild(overlay);
                
                if (slide.title || slide.description || slide.link) {
                    const slideContent = document.createElement('div');
                    slideContent.className = 'slide-content';
                    
                    if (slide.title) {
                        const title = document.createElement('h2');
                        title.textContent = slide.title;
                        title.style.fontSize = '2.5rem';
                        title.style.marginBottom = '1rem';
                        slideContent.appendChild(title);
                    }
                    
                    if (slide.description) {
                        const description = document.createElement('p');
                        description.textContent = slide.description;
                        description.style.fontSize = '1.2rem';
                        description.style.maxWidth = '800px';
                        description.style.marginBottom = '1.5rem';
                        slideContent.appendChild(description);
                    }
                    
                    if (slide.link) {
                        const link = document.createElement('a');
                        link.href = slide.link;
                        link.textContent = slide.link_text || 'Læs mere';
                        link.style.display = 'inline-block';
                        link.style.padding = '0.75rem 1.5rem';
                        link.style.backgroundColor = 'var(--accent-color)';
                        link.style.color = 'var(--primary-color)';
                        link.style.textDecoration = 'none';
                        link.style.borderRadius = '4px';
                        link.style.fontWeight = 'bold';
                        link.style.transition = 'background-color 0.3s, transform 0.3s';
                        
                        link.addEventListener('mouseover', () => {
                            link.style.backgroundColor = 'var(--bright-color)';
                            link.style.transform = 'translateY(-3px)';
                        });
                        
                        link.addEventListener('mouseout', () => {
                            link.style.backgroundColor = 'var(--accent-color)';
                            link.style.transform = 'translateY(0)';
                        });
                        
                        slideContent.appendChild(link);
                    }
                    
                    slideElement.appendChild(slideContent);
                }
                
                slideshowContainer.appendChild(slideElement);
            });
            
            bandElement.appendChild(slideshowContainer);
            
            // Add navigation dots
            const slideshowNav = document.createElement('div');
            slideshowNav.className = 'slideshow-nav';
            
            slides.forEach((_, index) => {
                const dot = document.createElement('div');
                dot.className = 'slideshow-dot';
                if (index === 0) dot.classList.add('active');
                
                dot.addEventListener('click', () => {
                    slideshowContainer.style.transform = `translateX(-${index * 100}%)`;
                    
                    // Update active dots
                    const dots = slideshowNav.querySelectorAll('.slideshow-dot');
                    dots.forEach(d => d.classList.remove('active'));
                    dot.classList.add('active');
                });
                
                slideshowNav.appendChild(dot);
            });
            
            bandElement.appendChild(slideshowNav);
            
            // Automatic slide change
            let currentSlide = 0;
            setInterval(() => {
                currentSlide = (currentSlide + 1) % slides.length;
                slideshowContainer.style.transform = `translateX(-${currentSlide * 100}%)`;
                
                // Update active dots
                const dots = slideshowNav.querySelectorAll('.slideshow-dot');
                dots.forEach(d => d.classList.remove('active'));
                dots[currentSlide].classList.add('active');
            }, 5000);
        }
        
        // Render product band
        function renderProductBand(bandElement, band) {
            const content = band.band_content || {};
            const products = content.products || [];
            
            const bandContent = document.createElement('div');
            bandContent.className = 'band-content';
            
            if (content.title) {
                const title = document.createElement('h2');
                title.textContent = content.title;
                title.style.textAlign = 'center';
                title.style.marginBottom = '2rem';
                title.style.fontSize = '2.2rem';
                bandContent.appendChild(title);
            }
            
            if (content.description) {
                const description = document.createElement('p');
                description.textContent = content.description;
                description.style.textAlign = 'center';
                description.style.maxWidth = '800px';
                description.style.margin = '0 auto 3rem auto';
                description.style.fontSize = '1.1rem';
                bandContent.appendChild(description);
            }
            
            if (products.length === 0) {
                const emptyMessage = document.createElement('p');
                emptyMessage.textContent = 'Ingen produkter fundet.';
                emptyMessage.style.textAlign = 'center';
                bandContent.appendChild(emptyMessage);
                bandElement.appendChild(bandContent);
                return;
            }
            
            const productContainer = document.createElement('div');
            productContainer.className = 'product-container';
            
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                if (product.image) {
                    const imageContainer = document.createElement('div');
                    imageContainer.className = 'product-image-container';
                    
                    const image = document.createElement('img');
                    image.src = product.image;
                    image.alt = product.title || 'Produkt';
                    image.className = 'product-image';
                    
                    imageContainer.appendChild(image);
                    productCard.appendChild(imageContainer);
                }
                
                const productInfo = document.createElement('div');
                productInfo.className = 'product-info';
                
                if (product.title) {
                    const title = document.createElement('h3');
                    title.className = 'product-title';
                    title.textContent = product.title;
                    productInfo.appendChild(title);
                }
                
                if (product.description) {
                    const description = document.createElement('p');
                    description.textContent = product.description;
                    productInfo.appendChild(description);
                }
                
                if (product.price) {
                    const price = document.createElement('div');
                    price.className = 'product-price';
                    price.textContent = `${product.price} kr.`;
                    productInfo.appendChild(price);
                }
                
                const addToCartButton = document.createElement('button');
                addToCartButton.textContent = 'Læg i kurv';
                addToCartButton.className = 'product-button';
                
                addToCartButton.addEventListener('click', () => {
                    alert(`Produkt tilføjet til kurven: ${product.title}`);
                });
                
                productInfo.appendChild(addToCartButton);
                productCard.appendChild(productInfo);
                productContainer.appendChild(productCard);
            });
            
            bandContent.appendChild(productContainer);
            
            if (content.show_more_link) {
                const moreContainer = document.createElement('div');
                moreContainer.style.textAlign = 'center';
                moreContainer.style.marginTop = '3rem';
                
                const moreLink = document.createElement('a');
                moreLink.href = content.show_more_link;
                moreLink.textContent = content.show_more_text || 'Se alle produkter';
                moreLink.className = 'product-button';
                moreLink.style.display = 'inline-block';
                moreLink.style.maxWidth = '300px';
                
                moreContainer.appendChild(moreLink);
                bandContent.appendChild(moreContainer);
            }
            
            bandElement.appendChild(bandContent);
        }
        
        // Render HTML band
        function renderHtmlBand(bandElement, band) {
            const content = band.band_content || {};
            const html = content.html || '';
            
            const bandContent = document.createElement('div');
            bandContent.className = 'band-content';
            bandContent.innerHTML = html;
            
            bandElement.appendChild(bandContent);
        }
        
        // Render related products band
        function renderRelatedProductsBand(bandElement, band) {
            const content = band.band_content || {};
            
            const bandContent = document.createElement('div');
            bandContent.className = 'band-content';
            
            const title = document.createElement('h2');
            title.textContent = content.title || 'Relaterede produkter';
            title.style.textAlign = 'center';
            title.style.marginBottom = '2rem';
            bandContent.appendChild(title);
            
            // In a real implementation we would fetch related products from API
            // For now we use dummy products
            const products = [
                {
                    title: 'Relateret produkt 1',
                    description: 'Beskrivelse af relateret produkt 1',
                    price: 299,
                    image: 'https://via.placeholder.com/300x200?text=Produkt+1'
                },
                {
                    title: 'Relateret produkt 2',
                    description: 'Beskrivelse af relateret produkt 2',
                    price: 399,
                    image: 'https://via.placeholder.com/300x200?text=Produkt+2'
                },
                {
                    title: 'Relateret produkt 3',
                    description: 'Beskrivelse af relateret produkt 3',
                    price: 499,
                    image: 'https://via.placeholder.com/300x200?text=Produkt+3'
                }
            ];
            
            const productContainer = document.createElement('div');
            productContainer.className = 'product-container';
            
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                if (product.image) {
                    const image = document.createElement('img');
                    image.src = product.image;
                    image.alt = product.title || 'Produkt';
                    image.className = 'product-image';
                    productCard.appendChild(image);
                }
                
                const productInfo = document.createElement('div');
                productInfo.className = 'product-info';
                
                if (product.title) {
                    const title = document.createElement('h3');
                    title.className = 'product-title';
                    title.textContent = product.title;
                    productInfo.appendChild(title);
                }
                
                if (product.description) {
                    const description = document.createElement('p');
                    description.textContent = product.description;
                    productInfo.appendChild(description);
                }
                
                if (product.price) {
                    const price = document.createElement('div');
                    price.className = 'product-price';
                    price.textContent = `${product.price} kr.`;
                    productInfo.appendChild(price);
                }
                
                const addToCartButton = document.createElement('button');
                addToCartButton.textContent = 'Læg i kurv';
                addToCartButton.style.marginTop = '1rem';
                addToCartButton.style.padding = '0.5rem 1rem';
                addToCartButton.style.backgroundColor = 'var(--accent-color)';
                addToCartButton.style.color = 'var(--primary-color)';
                addToCartButton.style.border = 'none';
                addToCartButton.style.borderRadius = '4px';
                addToCartButton.style.cursor = 'pointer';
                
                addToCartButton.addEventListener('click', () => {
                    alert(`Produkt tilføjet til kurven: ${product.title}`);
                });
                
                productInfo.appendChild(addToCartButton);
                productCard.appendChild(productInfo);
                productContainer.appendChild(productCard);
            });
            
            bandContent.appendChild(productContainer);
            bandElement.appendChild(bandContent);
        }
        
        // Render link band
        function renderLinkBand(bandElement, band) {
            const content = band.band_content || {};
            
            const bandContent = document.createElement('div');
            bandContent.className = 'band-content';
            
            if (content.title) {
                const title = document.createElement('h2');
                title.textContent = content.title;
                bandContent.appendChild(title);
            }
            
            if (content.description) {
                const description = document.createElement('p');
                description.textContent = content.description;
                bandContent.appendChild(description);
            }
            
            if (content.link) {
                const linkContainer = document.createElement('div');
                linkContainer.style.marginTop = '1rem';
                
                const link = document.createElement('a');
                link.href = content.link;
                link.textContent = content.link_text || 'Læs mere';
                link.className = 'button';
                
                linkContainer.appendChild(link);
                bandContent.appendChild(linkContainer);
            }
            
            bandElement.appendChild(bandContent);
        }
        
        // Cookie handling
        function initCookieBanner() {
            const cookieBanner = document.getElementById('cookieBanner');
            const acceptButton = document.getElementById('acceptCookiesButton');
            const rejectButton = document.getElementById('rejectCookiesButton');
            const settingsButton = document.getElementById('cookieSettingsButton');
            
            // Check if user has already made a decision about cookies
            const cookieConsent = localStorage.getItem('cookieConsent');
            
            if (cookieConsent === null) {
                // If no decision has been made, show banner
                cookieBanner.style.display = 'flex';
            }
            
            // Handle cookie acceptance
            acceptButton.addEventListener('click', () => {
                localStorage.setItem('cookieConsent', 'accepted');
                cookieBanner.style.display = 'none';
            });
            
            // Handle cookie rejection
            rejectButton.addEventListener('click', () => {
                localStorage.setItem('cookieConsent', 'rejected');
                cookieBanner.style.display = 'none';
            });
            
            // Handle click on cookie settings
            settingsButton.addEventListener('click', () => {
                cookieBanner.style.display = 'flex';
            });
        }
        
        // Initialization
        async function init() {
            // Set default styles immediately
            setDefaultStyles();
            
            // Determine which page to show based on URL
            const url = new URL(window.location.href);
            const pathSegments = url.pathname.split('/').filter(segment => segment);
            
            let pageId = 'forside'; // Default to front page
            
            if (pathSegments.length > 0) {
                pageId = pathSegments[0];
            }
            
            // Load page
            await loadPage(pageId);
            
            // Initialize cookie banner
            initCookieBanner();
        }
        
        // Start app
        init();
    </script>
</body>
</html>
