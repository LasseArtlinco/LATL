<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LATL Administration</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Allerta+Stencil&family=Open+Sans:wght@300;400;600;700&family=Montserrat:wght@400;500;600;700&family=Raleway:wght@400;500;600;700&family=Playfair+Display:wght@400;500;600;700&family=Roboto:wght@300;400;500;700&family=Lato:wght@300;400;700&family=Source+Sans+Pro:wght@300;400;600;700&family=PT+Sans:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/admin-style.css">
    <style>
        /* Admin Dashboard Specific Styles */
        .admin-container {
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 250px;
            background-color: var(--primary-color);
            color: white;
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }
        
        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }
        
        .sidebar-logo {
            font-family: 'Allerta Stencil', sans-serif;
            font-size: 24px;
            margin: 0;
        }
        
        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .sidebar-menu li {
            margin-bottom: 5px;
        }
        
        .sidebar-menu a, .sidebar-submenu-toggle {
            display: block;
            padding: 12px 20px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        
        .sidebar-menu a:hover, .sidebar-submenu-toggle:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .sidebar-menu a.active, .sidebar-submenu-toggle.active {
            background-color: var(--accent-color);
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .sidebar-menu-icon {
            margin-right: 10px;
            width: 20px;
            text-align: center;
            font-size: 16px;
        }
        
        .sidebar-submenu {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        .sidebar-submenu.expanded {
            max-height: 500px;
        }
        
        .sidebar-submenu a {
            padding-left: 50px;
            font-size: 13px;
        }
        
        .toggle-icon {
            margin-left: auto;
            transition: transform 0.3s;
        }
        
        .sidebar-submenu-toggle.active .toggle-icon {
            transform: rotate(180deg);
        }
        
        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 20px;
            background-color: var(--background-color);
        }
        
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--medium-gray);
        }
        
        .page-title {
            margin: 0;
        }
        
        .tab-container {
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }
        
        .tab-nav {
            display: flex;
            border-bottom: 1px solid var(--medium-gray);
            background-color: var(--light-gray);
        }
        
        .tab-button {
            padding: 15px 20px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark-gray);
            transition: all 0.3s;
        }
        
        .tab-button:hover {
            background-color: rgba(0, 0, 0, 0.02);
            color: var(--primary-color);
        }
        
        .tab-button.active {
            background-color: white;
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        
        .tab-content {
            padding: 20px;
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Style Preview */
        .style-preview {
            background-color: white;
            border-radius: 4px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .color-palette {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .color-block {
            width: 100px;
            height: 100px;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            font-size: 12px;
            position: relative;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .color-block.light-text {
            color: var(--text-color);
            text-shadow: none;
        }
        
        .color-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .color-value {
            font-size: 10px;
            opacity: 0.8;
        }
        
        .font-preview {
            margin-top: 30px;
        }
        
        .font-preview-item {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--medium-gray);
        }
        
        .font-preview-label {
            font-size: 12px;
            color: var(--dark-gray);
            margin-bottom: 8px;
            display: block;
        }
        
        .font-preview-heading {
            margin: 0;
        }
        
        .font-preview-body {
            margin: 0;
        }
        
        .font-preview-price {
            font-size: 24px;
            margin: 10px 0;
        }
        
        .font-preview-button {
            display: inline-block;
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 4px;
            margin-top: 10px;
        }
        
        .band-preview {
            margin-bottom: 20px;
            border: 1px solid var(--medium-gray);
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }
        
        .band-preview::before {
            content: attr(data-height) "x h√∏jde";
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 10;
        }
        
        .band-preview-content {
            width: 100%;
            height: 150px;
            background-color: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .band-preview[data-height="2"] .band-preview-content {
            height: 300px;
        }
        
        .band-preview[data-height="3"] .band-preview-content {
            height: 450px;
        }
        
        .band-preview[data-height="4"] .band-preview-content {
            height: 600px;
        }
        
        .band-preview-type {
            margin: 0;
            color: var(--dark-gray);
        }
        
        .grid-view {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .band-card {
            background-color: white;
            border-radius: 4px;
            border: 1px solid var(--medium-gray);
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: box-shadow 0.3s, transform 0.3s;
        }
        
        .band-card:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        
        .band-card-preview {
            height: 150px;
            background-color: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark-gray);
            font-size: 24px;
            position: relative;
        }
        
        .band-card-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--primary-color);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }
        
        .band-card-body {
            padding: 15px;
        }
        
        .band-card-title {
            margin: 0 0 5px 0;
            font-size: 18px;
        }
        
        .band-card-meta {
            font-size: 13px;
            color: var(--dark-gray);
            margin-bottom: 15px;
        }
        
        .band-card-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-button {
            padding: 6px 12px;
            font-size: 13px;
            flex: 1;
            text-align: center;
        }
        
        /* Responsive styling */
        @media (max-width: 992px) {
            .sidebar {
                width: 70px;
                padding: 15px 0;
            }
            
            .sidebar-header {
                padding: 0 10px 15px;
                text-align: center;
            }
            
            .sidebar-logo {
                font-size: 20px;
            }
            
            .sidebar-menu a, .sidebar-submenu-toggle {
                padding: 12px 10px;
                justify-content: center;
            }
            
            .sidebar-menu-text, .toggle-icon {
                display: none;
            }
            
            .sidebar-menu-icon {
                margin-right: 0;
            }
            
            .main-content {
                margin-left: 70px;
            }
            
            .sidebar-submenu a {
                padding-left: 10px;
            }
        }
        
        @media (max-width: 768px) {
            .admin-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: static;
                padding: 10px 0;
            }
            
            .sidebar-menu {
                display: flex;
                flex-wrap: wrap;
            }
            
            .sidebar-menu li {
                margin-bottom: 0;
            }
            
            .sidebar-menu a, .sidebar-submenu-toggle {
                padding: 10px;
            }
            
            .sidebar-menu-text {
                display: none;
            }
            
            .sidebar-submenu {
                position: absolute;
                background-color: var(--primary-color);
                z-index: 10;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                border-radius: 0 0 4px 4px;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .color-block {
                width: 80px;
                height: 80px;
            }
        }
    </style>
</head>
<body>
    <div class="loading">
        <div class="spinner"></div>
    </div>
    
    <div class="toast" id="toast"></div>
    
    <div class="admin-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-logo">LATL</h1>
            </div>
            <ul class="sidebar-menu">
                <li>
                    <a href="#dashboard" class="sidebar-menu-item active" data-section="dashboard">
                        <span class="sidebar-menu-icon">üìä</span>
                        <span class="sidebar-menu-text">Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="#layout" class="sidebar-menu-item" data-section="layout">
                        <span class="sidebar-menu-icon">üé®</span>
                        <span class="sidebar-menu-text">Layout</span>
                    </a>
                </li>
                <li>
                    <div class="sidebar-submenu-toggle" data-submenu="bands">
                        <span class="sidebar-menu-icon">üìã</span>
                        <span class="sidebar-menu-text">B√•nd</span>
                        <span class="toggle-icon">‚ñº</span>
                    </div>
                    <ul class="sidebar-submenu" id="bands-submenu">
                        <li>
                            <a href="#bands-management" class="sidebar-menu-item" data-section="bands-management">
                                B√•nd Oversigt
                            </a>
                        </li>
                        <li>
                            <a href="#band-editor" class="sidebar-menu-item" data-section="band-editor">
                                B√•nd Editor
                            </a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#products" class="sidebar-menu-item" data-section="products">
                        <span class="sidebar-menu-icon">üõçÔ∏è</span>
                        <span class="sidebar-menu-text">Produkter</span>
                    </a>
                </li>
                <li>
                    <a href="#orders" class="sidebar-menu-item" data-section="orders">
                        <span class="sidebar-menu-icon">üì¶</span>
                        <span class="sidebar-menu-text">Ordrer</span>
                    </a>
                </li>
                <li>
                    <a href="#analytics" class="sidebar-menu-item" data-section="analytics">
                        <span class="sidebar-menu-icon">üìà</span>
                        <span class="sidebar-menu-text">Analyse</span>
                    </a>
                </li>
                <li>
                    <a href="#accounting" class="sidebar-menu-item" data-section="accounting">
                        <span class="sidebar-menu-icon">üí∞</span>
                        <span class="sidebar-menu-text">Regnskab</span>
                    </a>
                </li>
                <li>
                    <a href="#settings" class="sidebar-menu-item" data-section="settings">
                        <span class="sidebar-menu-icon">‚öôÔ∏è</span>
                        <span class="sidebar-menu-text">Indstillinger</span>
                    </a>
                </li>
            </ul>
        </aside>
        
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard-section" class="content-section active">
                <div class="page-header">
                    <h1 class="page-title">Dashboard</h1>
                </div>
                <div class="dashboard-content">
                    <p>Velkommen til LATL Administration. V√¶lg en sektion i menuen til venstre for at komme i gang.</p>
                    <p>Her vil fremtidige dashboardfunktioner blive vist.</p>
                </div>
            </section>
            
            <!-- Layout Section -->
            <section id="layout-section" class="content-section">
                <div class="page-header">
                    <h1 class="page-title">Layout Indstillinger</h1>
                    <div>
                        <button id="saveGlobalStylesButton" class="primary">Gem √¶ndringer</button>
                    </div>
                </div>
                
                <div class="tab-container">
                    <div class="tab-nav">
                        <button class="tab-button active" data-tab="globalStyles">Globale stilarter</button>
                        <button class="tab-button" data-tab="layoutPages">Layout sider</button>
                    </div>
                    
                    <div id="globalStyles" class="tab-content active">
                        <div class="form-row">
                            <div>
                                <h3>Farvepalette</h3>
                                <div id="colorPalette">
                                    <div class="form-group">
                                        <label>Prim√¶r farve</label>
                                        <div class="form-row">
                                            <input type="color" id="primaryColor" value="#042940">
                                            <input type="text" id="primaryColorHex" value="#042940">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Sekund√¶r farve</label>
                                        <div class="form-row">
                                            <input type="color" id="secondaryColor" value="#005C53">
                                            <input type="text" id="secondaryColorHex" value="#005C53">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Accent farve</label>
                                        <div class="form-row">
                                            <input type="color" id="accentColor" value="#9FC131">
                                            <input type="text" id="accentColorHex" value="#9FC131">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Lys accent farve</label>
                                        <div class="form-row">
                                            <input type="color" id="brightColor" value="#DBF227">
                                            <input type="text" id="brightColorHex" value="#DBF227">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Baggrund</label>
                                        <div class="form-row">
                                            <input type="color" id="backgroundColor" value="#D6D58E">
                                            <input type="text" id="backgroundColorHex" value="#D6D58E">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Tekstfarve</label>
                                        <div class="form-row">
                                            <input type="color" id="textColor" value="#042940">
                                            <input type="text" id="textColorHex" value="#042940">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h3>Skrifttyper</h3>
                                <div id="fontConfig">
                                    <div class="form-group">
                                        <label>Overskrift skrifttype</label>
                                        <select id="headingFontFamily">
                                            <option value="'Allerta Stencil', sans-serif">Allerta Stencil</option>
                                            <option value="'Open Sans', sans-serif">Open Sans</option>
                                            <option value="Arial, sans-serif">Arial</option>
                                            <option value="'Helvetica Neue', sans-serif">Helvetica Neue</option>
                                            <option value="'Roboto', sans-serif">Roboto</option>
                                            <option value="'Montserrat', sans-serif">Montserrat</option>
                                            <option value="'Raleway', sans-serif">Raleway</option>
                                            <option value="'Playfair Display', serif">Playfair Display</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Overskrift tykkelse</label>
                                        <select id="headingFontWeight">
                                            <option value="400">Normal (400)</option>
                                            <option value="500">Medium (500)</option>
                                            <option value="600">Semi-bold (600)</option>
                                            <option value="700" selected>Bold (700)</option>
                                            <option value="800">Extra-bold (800)</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Br√∏dtekst skrifttype</label>
                                        <select id="bodyFontFamily">
                                            <option value="'Open Sans', sans-serif" selected>Open Sans</option>
                                            <option value="'Allerta Stencil', sans-serif">Allerta Stencil</option>
                                            <option value="Arial, sans-serif">Arial</option>
                                            <option value="'Helvetica Neue', sans-serif">Helvetica Neue</option>
                                            <option value="'Roboto', sans-serif">Roboto</option>
                                            <option value="'Lato', sans-serif">Lato</option>
                                            <option value="'Source Sans Pro', sans-serif">Source Sans Pro</option>
                                            <option value="'PT Sans', sans-serif">PT Sans</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Br√∏dtekst tykkelse</label>
                                        <select id="bodyFontWeight">
                                            <option value="300">Light (300)</option>
                                            <option value="400" selected>Normal (400)</option>
                                            <option value="500">Medium (500)</option>
                                            <option value="600">Semi-bold (600)</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Pris skrifttype</label>
                                        <select id="priceFontFamily">
                                            <option value="'Allerta Stencil', sans-serif" selected>Allerta Stencil</option>
                                            <option value="'Open Sans', sans-serif">Open Sans</option>
                                            <option value="Arial, sans-serif">Arial</option>
                                            <option value="'Helvetica Neue', sans-serif">Helvetica Neue</option>
                                            <option value="'Roboto', sans-serif">Roboto</option>
                                            <option value="'Montserrat', sans-serif">Montserrat</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Pris tykkelse</label>
                                        <select id="priceFontWeight">
                                            <option value="400">Normal (400)</option>
                                            <option value="500">Medium (500)</option>
                                            <option value="600">Semi-bold (600)</option>
                                            <option value="700" selected>Bold (700)</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Knap skrifttype</label>
                                        <select id="buttonFontFamily">
                                            <option value="'Open Sans', sans-serif" selected>Open Sans</option>
                                            <option value="'Allerta Stencil', sans-serif">Allerta Stencil</option>
                                            <option value="Arial, sans-serif">Arial</option>
                                            <option value="'Helvetica Neue', sans-serif">Helvetica Neue</option>
                                            <option value="'Roboto', sans-serif">Roboto</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Knap tykkelse</label>
                                        <select id="buttonFontWeight">
                                            <option value="400">Normal (400)</option>
                                            <option value="500">Medium (500)</option>
                                            <option value="600" selected>Semi-bold (600)</option>
                                            <option value="700">Bold (700)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <h3>Global styling</h3>
                        <div class="form-group">
                            <label>CSS kode (avanceret)</label>
                            <textarea id="globalCss" rows="8" placeholder="Indtast din CSS-kode her...">/* Eksempel p√• global styling */
body {
  line-height: 1.6;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 15px;
}

.button {
  transition: all 0.3s ease;
}

.button:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}</textarea>
                        </div>
                        
                        <div class="style-preview">
                            <h3>Forh√•ndsvisning</h3>
                            <p class="help-text">Denne forh√•ndsvisning viser dine valgte stilarter.</p>
                            
                            <div class="color-palette" id="colorPalettePreview">
                                <!-- Color blocks will be generated here -->
                            </div>
                            
                            <div class="font-preview" id="fontPreview">
                                <!-- Font preview will be generated here -->
                            </div>
                        </div>
                    </div>
                    
                    <div id="layoutPages" class="tab-content">
                        <div class="form-row">
                            <div>
                                <label>V√¶lg side</label>
                                <select id="pageSelect">
                                    <option value="">-- V√¶lg side --</option>
                                </select>
                            </div>
                            <div>
                                <label>Eller opret ny side</label>
                                <div class="form-row">
                                    <input type="text" id="newPageId" placeholder="Indtast side-id (f.eks. 'forside')">
                                    <button id="createPageButton">Opret</button>
                                </div>
                            </div>
                        </div>
                        
                        <div id="pageDetails" style="display: none;">
                            <h3>Side detaljer</h3>
                            <div class="form-group">
                                <label>Side ID</label>
                                <input type="text" id="currentPageId" disabled>
                            </div>
                            
                            <h3>Layout data</h3>
                            <div class="form-group">
                                <label>Layout data (JSON)</label>
                                <textarea id="layoutData" rows="10" placeholder="Layout data i JSON format..."></textarea>
                            </div>
                            
                            <div class="form-row">
                                <button id="updatePageButton">Opdater side</button>
                                <button id="deletePageButton" class="danger">Slet side</button>
                                <button id="viewBandsButton" class="secondary">Administrer b√•nd</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Bands Management Section -->
            <section id="bands-management-section" class="content-section">
                <div class="page-header">
                    <h1 class="page-title">B√•nd Oversigt</h1>
                    <div>
                        <button id="add-band-button" class="primary">Tilf√∏j nyt b√•nd</button>
                    </div>
                </div>
                
                <div class="form-section">
                    <h2>V√¶lg side</h2>
                    <div class="form-group">
                        <select id="band-page-select">
                            <option value="">-- V√¶lg side --</option>
                            <!-- Sider hentes fra API -->
                        </select>
                    </div>
                </div>
                
                <div id="bands-container" class="bands-container" style="display: none;">
                    <h2>B√•nd p√• denne side</h2>
                    <div id="bands-list" class="bands-list grid-view">
                        <!-- B√•nd vises her -->
                    </div>
                </div>
                
                <div id="no-bands-message" class="info-message" style="display: none;">
                    <p>Ingen b√•nd fundet p√• denne side. Klik p√• "Tilf√∏j nyt b√•nd" for at oprette et.</p>
                </div>
            </section>
            
            <!-- Band Editor Section -->
            <section id="band-editor-section" class="content-section">
                <div class="page-header">
                    <h1 class="page-title">B√•nd Editor</h1>
                    <div>
                        <button id="cancel-button" class="secondary">Annuller</button>
                        <button id="save-button" class="primary">Gem b√•nd</button>
                    </div>
                </div>
                
                <div class="form-section">
                    <h2>Grundl√¶ggende b√•nd information</h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="band-type">B√•nd type</label>
                            <select id="band-type">
                                <option value="slideshow">Slideshow</option>
                                <option value="product">Produkt (konfigurerbart)</option>
                                <option value="product_card">Produkt kort</option>
                                <option value="product_full">Produkt fuld</option>
                                <option value="html">HTML</option>
                                <option value="related_products">Relaterede produkter</option>
                                <option value="link">Link</option>
                                <option value="cta">Call to Action</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="band-height">B√•nd h√∏jde</label>
                            <select id="band-height">
                                <option value="1">1x</option>
                                <option value="2">2x</option>
                                <option value="3">3x</option>
                                <option value="4">4x</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="band-order">R√¶kkef√∏lge</label>
                            <input type="number" id="band-order" min="1" value="1">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="band-page">Side</label>
                        <select id="band-page">
                            <option value="">-- V√¶lg side --</option>
                            <!-- Sider hentes fra API -->
                        </select>
                    </div>
                </div>
                
                <!-- Slideshow Editor -->
                <div id="slideshow-editor" class="form-section">
                    <h2>Slideshow indstillinger</h2>
                    
                    <button class="add-slide-btn" id="add-slide">Tilf√∏j nyt slide</button>
                    
                    <div id="slides-container">
                        <!-- Slides tilf√∏jes her dynamisk -->
                    </div>
                </div>
                
                <!-- Configurable Product Editor -->
                <div id="product-editor" class="form-section hidden-tab">
                    <h2>Produkt indstillinger</h2>
                    
                    <div class="form-group">
                        <label for="product-title">Titel</label>
                        <input type="text" id="product-title" placeholder="Indtast produkttitel">
                    </div>
                    
                    <div class="form-group">
                        <label for="product-subtitle">Undertitel</label>
                        <input type="text" id="product-subtitle" placeholder="Indtast undertitel">
                    </div>
                    
                    <div class="form-group">
                        <label for="product-link">Link (valgfrit)</label>
                        <input type="text" id="product-link" placeholder="f.eks. /produkt/l√¶derprodukt">
                    </div>
                    
                    <div class="form-group">
                        <label for="product-background">Baggrundsfarve</label>
                        <div class="form-row">
                            <input type="color" id="product-background" value="#ffffff">
                            <input type="text" id="product-background-hex" value="#ffffff">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="product-image">Produkt billede (PNG med gennemsigtig baggrund)</label>
                        <div id="product-image-preview" class="image-preview" style="display: none;">
                            <img src="" alt="Produkt forh√•ndsvisning">
                        </div>
                        <input type="file" id="product-image" accept="image/png">
                    </div>
                </div>
                
                <!-- SEO indstillinger -->
                <div class="form-section">
                    <h2>SEO indstillinger</h2>
                    
                    <div class="form-group">
                        <label for="seo-title">SEO Titel</label>
                        <input type="text" id="seo-title" placeholder="Indtast SEO titel">
                        <p class="help-text">Denne titel vil blive brugt i metadata og hj√¶lper med SEO.</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="seo-description">SEO Beskrivelse</label>
                        <textarea id="seo-description" rows="3" placeholder="Indtast SEO beskrivelse"></textarea>
                        <p class="help-text">En kort beskrivelse af b√•ndets indhold for s√∏gemaskiner.</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="seo-keywords">SEO N√∏gleord</label>
                        <input type="text" id="seo-keywords" placeholder="Indtast n√∏gleord adskilt af komma">
                        <p class="help-text">Relevante n√∏gleord for dette b√•nd.</p>
                    </div>
                </div>
                
                <!-- Preview section -->
                <div class="preview-section">
                    <h2>Forh√•ndsvisning</h2>
                    <div id="preview-container">
                        <!-- Preview renderes her dynamisk -->
                    </div>
                </div>
            </section>
            
            <!-- Placeholder for future sections -->
            <section id="products-section" class="content-section">
                <div class="page-header">
                    <h1 class="page-title">Produkter</h1>
                </div>
                <p>Produktadministration vil v√¶re tilg√¶ngelig i en fremtidig opdatering.</p>
            </section>
            
            <section id="orders-section" class="content-section">
                <div class="page-header">
                    <h1 class="page-title">Ordrer</h1>
                </div>
                <p>Ordreadministration vil v√¶re tilg√¶ngelig i en fremtidig opdatering.</p>
            </section>
            
            <section id="analytics-section" class="content-section">
                <div class="page-header">
                    <h1 class="page-title">Analyse</h1>
                </div>
                <p>Analysev√¶rkt√∏jer vil v√¶re tilg√¶ngelige i en fremtidig opdatering.</p>
            </section>
            
            <section id="accounting-section" class="content-section">
                <div class="page-header">
                    <h1 class="page-title">Regnskab</h1>
                </div>
                <p>Regnskabsadministration vil v√¶re tilg√¶ngelig i en fremtidig opdatering.</p>
            </section>
            
            <section id="settings-section" class="content-section">
                <div class="page-header">
                    <h1 class="page-title">Indstillinger</h1>
                </div>
                <p>Systemindstillinger vil v√¶re tilg√¶ngelige i en fremtidig opdatering.</p>
            </section>
        </main>
    </div>
    
    <!-- Slide template (skjult) -->
    <template id="slide-template">
        <div class="slide-container" data-slide-index="{index}">
            <button class="remove-slide" title="Fjern slide">&times;</button>
            
            <div class="slide-header">
                <h3>Slide {index_human}</h3>
                <div class="slide-controls">
                    <button class="move-slide-up" title="Flyt op">&#8593;</button>
                    <button class="move-slide-down" title="Flyt ned">&#8595;</button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="slide-title-{index}">Titel</label>
                <input type="text" id="slide-title-{index}" class="slide-title" placeholder="Indtast slide titel">
            </div>
            
            <div class="form-group">
                <label for="slide-subtitle-{index}">Undertitel</label>
                <input type="text" id="slide-subtitle-{index}" class="slide-subtitle" placeholder="Indtast undertitel">
            </div>
            
            <div class="form-group">
                <label for="slide-link-{index}">Link (valgfrit)</label>
                <input type="text" id="slide-link-{index}" class="slide-link" placeholder="f.eks. /produkt/l√¶derprodukt">
            </div>
            
            <div class="form-group">
                <label for="slide-image-{index}">Slide billede</label>
                <div class="image-preview slide-image-preview" style="display: none;">
                    <img src="" alt="Slide forh√•ndsvisning">
                </div>
                <input type="file" id="slide-image-{index}" class="slide-image" accept="image/jpeg,image/png,image/webp">
            </div>
            
            <div class="form-group">
                <label for="slide-alt-{index}">Billedtekst (alt-tekst)</label>
                <input type="text" id="slide-alt-{index}" class="slide-alt" placeholder="Beskrivende tekst til billedet for SEO">
                <p class="help-text">En beskrivende tekst til billedet, der hj√¶lper med tilg√¶ngelighed og SEO.</p>
            </div>
        </div>
    </template>
    
   <script src="js/admin-common.js"></script>
   <script src="js/band-editor.js"></script>
   <script src="js/admin_integration.js"></script>
    <script>
        // DOM elementer
        const sidebarMenuItems = document.querySelectorAll('.sidebar-menu-item');
        const contentSections = document.querySelectorAll('.content-section');
        const submenuToggles = document.querySelectorAll('.sidebar-submenu-toggle');
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        const colorInputs = document.querySelectorAll('input[type="color"]');
        const fontSelects = document.querySelectorAll('#fontConfig select');
        const colorPalettePreview = document.getElementById('colorPalettePreview');
        const fontPreview = document.getElementById('fontPreview');
        const saveGlobalStylesButton = document.getElementById('saveGlobalStylesButton');
        const viewBandsButton = document.getElementById('viewBandsButton');
        
        // API-adresse
        const API_URL = '/api';
        
        // Global state
        let currentPageId = null;
        let layouts = [];
        let globalStyles = {
            global_styles: {},
            font_config: {},
            color_palette: {}
        };
        
        // Event listener for sidebar menu items
        sidebarMenuItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                
                // Fjern aktiv klasse fra alle menupunkter
                sidebarMenuItems.forEach(menuItem => menuItem.classList.remove('active'));
                
                // Tilf√∏j aktiv klasse til det valgte menupunkt
                item.classList.add('active');
                
                // Vis den valgte sektion
                const sectionId = item.dataset.section;
                showSection(sectionId);
            });
        });
        
        // Event listener for submenu toggles
        submenuToggles.forEach(toggle => {
            toggle.addEventListener('click', () => {
                const submenuId = toggle.dataset.submenu;
                const submenu = document.getElementById(submenuId + '-submenu');
                
                // Toggle expanded class
                submenu.classList.toggle('expanded');
                toggle.classList.toggle('active');
            });
        });
        
        // Event listener for tab buttons
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.dataset.tab;
                
                // Fjern aktiv klasse fra alle tab buttons og tab contents
                tabButtons.forEach(btn => btn.classList.remove('active'));
                tabContents.forEach(content => content.classList.remove('active'));
                
                // Tilf√∏j aktiv klasse til den valgte tab button og tab content
                button.classList.add('active');
                document.getElementById(tabId).classList.add('active');
                
                // Opdater indhold baseret p√• valgt fane
                if (tabId === 'layoutPages') {
                    loadLayouts();
                } else if (tabId === 'globalStyles') {
                    updateStylePreview();
                }
            });
        });
        
        // Event listener for farvepalette
        colorInputs.forEach(colorInput => {
            const hexInput = document.getElementById(colorInput.id + 'Hex');
            
            colorInput.addEventListener('input', () => {
                hexInput.value = colorInput.value;
                updateStylePreview();
            });
            
            hexInput.addEventListener('input', () => {
                if (/^#[0-9A-F]{6}$/i.test(hexInput.value)) {
                    colorInput.value = hexInput.value;
                    updateStylePreview();
                }
            });
        });
        
        // Event listener for skrifttyper
        fontSelects.forEach(select => {
            select.addEventListener('change', updateStylePreview);
        });
        
        // Event listener for global styles save button
        saveGlobalStylesButton.addEventListener('click', saveGlobalStyles);
        
        // Event listener for view bands button
        viewBandsButton.addEventListener('click', () => {
            const pageId = document.getElementById('currentPageId').value;
            if (pageId) {
                document.getElementById('band-page-select').value = pageId;
                loadBandsForPage(pageId);
                showSection('bands-management');
                
                // Activate the bands menu item
                sidebarMenuItems.forEach(item => item.classList.remove('active'));
                document.querySelector('[data-section="bands-management"]').classList.add('active');
                
                // Expand the bands submenu if collapsed
                const bandsSubmenu = document.getElementById('bands-submenu');
                if (!bandsSubmenu.classList.contains('expanded')) {
                    bandsSubmenu.classList.add('expanded');
                    document.querySelector('[data-submenu="bands"]').classList.add('active');
                }
            }
        });
        
        // Event listeners for page management
        document.getElementById('pageSelect').addEventListener('change', handlePageChange);
        document.getElementById('createPageButton').addEventListener('click', createNewPage);
        document.getElementById('updatePageButton').addEventListener('click', updatePage);
        document.getElementById('deletePageButton').addEventListener('click', deletePage);
        
        // Event listeners for bands management
        document.getElementById('band-page-select').addEventListener('change', function() {
            loadBandsForPage(this.value);
        });
        document.getElementById('add-band-button').addEventListener('click', addNewBand);
        
        // Initialize
        document.addEventListener('DOMContentLoaded', init);
        
        /**
         * Initialize the app
         */
        async function init() {
            // Load global styles
            await loadGlobalStyles();
            
            // Load layouts
            await loadLayouts();
            
            // Update style preview
            updateStylePreview();
            
            // Handle URL hash for section navigation
            if (window.location.hash) {
                const sectionId = window.location.hash.substring(1);
                const menuItem = document.querySelector(`[data-section="${sectionId}"]`);
                if (menuItem) {
                    sidebarMenuItems.forEach(item => item.classList.remove('active'));
                    menuItem.classList.add('active');
                    showSection(sectionId);
                }
            }
        }
        
        /**
         * Show a specific section
         */
        function showSection(sectionId) {
            contentSections.forEach(section => section.classList.remove('active'));
            const section = document.getElementById(sectionId + '-section');
            if (section) {
                section.classList.add('active');
                
                // Update URL hash
                window.location.hash = sectionId;
                
                // Load data for specific sections
                if (sectionId === 'bands-management') {
                    loadPagesForBands();
                } else if (sectionId === 'band-editor') {
                    // Initialize band editor
                    // This is handled by band-editor.js
                }
            }
        }
        
        /**
         * Update style preview
         */
        function updateStylePreview() {
            // Update color palette preview
            const primaryColor = document.getElementById('primaryColor').value;
            const secondaryColor = document.getElementById('secondaryColor').value;
            const accentColor = document.getElementById('accentColor').value;
            const brightColor = document.getElementById('brightColor').value;
            const backgroundColor = document.getElementById('backgroundColor').value;
            const textColor = document.getElementById('textColor').value;
            
            // Clear existing preview
            colorPalettePreview.innerHTML = '';
            
            // Create color blocks
            const colors = [
                { name: 'Prim√¶r', value: primaryColor },
                { name: 'Sekund√¶r', value: secondaryColor },
                { name: 'Accent', value: accentColor },
                { name: 'Lys accent', value: brightColor, light: true },
                { name: 'Baggrund', value: backgroundColor, light: true },
                { name: 'Tekst', value: textColor }
            ];
            
            colors.forEach(color => {
                const colorBlock = document.createElement('div');
                colorBlock.className = 'color-block';
                if (color.light) colorBlock.classList.add('light-text');
                colorBlock.style.backgroundColor = color.value;
                
                const colorName = document.createElement('div');
                colorName.className = 'color-name';
                colorName.textContent = color.name;
                
                const colorValue = document.createElement('div');
                colorValue.className = 'color-value';
                colorValue.textContent = color.value;
                
                colorBlock.appendChild(colorName);
                colorBlock.appendChild(colorValue);
                colorPalettePreview.appendChild(colorBlock);
            });
            
            // Update font preview
            const headingFontFamily = document.getElementById('headingFontFamily').value;
            const headingFontWeight = document.getElementById('headingFontWeight').value;
            const bodyFontFamily = document.getElementById('bodyFontFamily').value;
            const bodyFontWeight = document.getElementById('bodyFontWeight').value;
            const priceFontFamily = document.getElementById('priceFontFamily').value;
            const priceFontWeight = document.getElementById('priceFontWeight').value;
            const buttonFontFamily = document.getElementById('buttonFontFamily').value;
            const buttonFontWeight = document.getElementById('buttonFontWeight').value;
            
            // Clear existing preview
            fontPreview.innerHTML = '';
            
            // Create heading preview
            const headingPreview = document.createElement('div');
            headingPreview.className = 'font-preview-item';
            
            const headingLabel = document.createElement('span');
            headingLabel.className = 'font-preview-label';
            headingLabel.textContent = 'Overskrift';
            
            const heading = document.createElement('h2');
            heading.className = 'font-preview-heading';
            heading.style.fontFamily = headingFontFamily;
            heading.style.fontWeight = headingFontWeight;
            heading.style.color = textColor;
            heading.textContent = 'Dette er en overskrift';
            
            headingPreview.appendChild(headingLabel);
            headingPreview.appendChild(heading);
            fontPreview.appendChild(headingPreview);
            
            // Create body text preview
            const bodyPreview = document.createElement('div');
            bodyPreview.className = 'font-preview-item';
            
            const bodyLabel = document.createElement('span');
            bodyLabel.className = 'font-preview-label';
            bodyLabel.textContent = 'Br√∏dtekst';
            
            const bodyText = document.createElement('p');
            bodyText.className = 'font-preview-body';
            bodyText.style.fontFamily = bodyFontFamily;
            bodyText.style.fontWeight = bodyFontWeight;
            bodyText.style.color = textColor;
            bodyText.textContent = 'Dette er en eksempel p√• br√∏dtekst. Br√∏dtekst bruges til at formidle information og indhold p√• websitet.';
            
            bodyPreview.appendChild(bodyLabel);
            bodyPreview.appendChild(bodyText);
            fontPreview.appendChild(bodyPreview);
            
            // Create price preview
            const pricePreview = document.createElement('div');
            pricePreview.className = 'font-preview-item';
            
            const priceLabel = document.createElement('span');
            priceLabel.className = 'font-preview-label';
            priceLabel.textContent = 'Pris';
            
            const price = document.createElement('div');
            price.className = 'font-preview-price';
            price.style.fontFamily = priceFontFamily;
            price.style.fontWeight = priceFontWeight;
            price.style.color = textColor;
            price.textContent = 'DKK 299,-';
            
            pricePreview.appendChild(priceLabel);
            pricePreview.appendChild(price);
            fontPreview.appendChild(pricePreview);
            
            // Create button preview
            const buttonPreview = document.createElement('div');
            buttonPreview.className = 'font-preview-item';
            
            const buttonLabel = document.createElement('span');
            buttonLabel.className = 'font-preview-label';
            buttonLabel.textContent = 'Knap';
            
            const button = document.createElement('div');
            button.className = 'font-preview-button';
            button.style.fontFamily = buttonFontFamily;
            button.style.fontWeight = buttonFontWeight;
            button.style.backgroundColor = primaryColor;
            button.textContent = 'K√∏b nu';
            
            buttonPreview.appendChild(buttonLabel);
            buttonPreview.appendChild(button);
            fontPreview.appendChild(buttonPreview);
        }
        
        /**
         * Load global styles
         */
        async function loadGlobalStyles() {
            try {
                showLoading();
                
                const response = await fetch(`${API_URL}/layout/global/styles`);
                const result = await response.json();
                
                if (result.status === 'success' && result.data) {
                    globalStyles = result.data;
                    
                    // Update UI with loaded data
                    const colorPalette = globalStyles.color_palette || {};
                    const fontConfig = globalStyles.font_config || {};
                    const styles = globalStyles.global_styles || {};
                    
                    // Update colors
                    if (colorPalette.primary) {
                        document.getElementById('primaryColor').value = colorPalette.primary;
                        document.getElementById('primaryColorHex').value = colorPalette.primary;
                    }
                    
                    if (colorPalette.secondary) {
                        document.getElementById('secondaryColor').value = colorPalette.secondary;
                        document.getElementById('secondaryColorHex').value = colorPalette.secondary;
                    }
                    
                    if (colorPalette.accent) {
                        document.getElementById('accentColor').value = colorPalette.accent;
                        document.getElementById('accentColorHex').value = colorPalette.accent;
                    }
                    
                    if (colorPalette.bright) {
                        document.getElementById('brightColor').value = colorPalette.bright;
                        document.getElementById('brightColorHex').value = colorPalette.bright;
                    }
                    
                    if (colorPalette.background) {
                        document.getElementById('backgroundColor').value = colorPalette.background;
                        document.getElementById('backgroundColorHex').value = colorPalette.background;
                    }
                    
                    if (colorPalette.text) {
                        document.getElementById('textColor').value = colorPalette.text;
                        document.getElementById('textColorHex').value = colorPalette.text;
                    }
                    
                    // Update fonts
                    if (fontConfig.heading) {
                        if (fontConfig.heading['font-family']) {
                            document.getElementById('headingFontFamily').value = fontConfig.heading['font-family'];
                        }
                        
                        if (fontConfig.heading['font-weight']) {
                            document.getElementById('headingFontWeight').value = fontConfig.heading['font-weight'];
                        }
                    }
                    
                    if (fontConfig.body) {
                        if (fontConfig.body['font-family']) {
                            document.getElementById('bodyFontFamily').value = fontConfig.body['font-family'];
                        }
                        
                        if (fontConfig.body['font-weight']) {
                            document.getElementById('bodyFontWeight').value = fontConfig.body['font-weight'];
                        }
                    }
                    
                    if (fontConfig.price) {
                        if (fontConfig.price['font-family']) {
                            document.getElementById('priceFontFamily').value = fontConfig.price['font-family'];
                        }
                        
                        if (fontConfig.price['font-weight']) {
                            document.getElementById('priceFontWeight').value = fontConfig.price['font-weight'];
                        }
                    }
                    
                    if (fontConfig.button) {
                        if (fontConfig.button['font-family']) {
                            document.getElementById('buttonFontFamily').value = fontConfig.button['font-family'];
                        }
                        
                        if (fontConfig.button['font-weight']) {
                            document.getElementById('buttonFontWeight').value = fontConfig.button['font-weight'];
                        }
                    }
                    
                    // Update CSS
                    if (styles.css) {
                        document.getElementById('globalCss').value = styles.css;
                    }
                    
                    // Update preview
                    updateStylePreview();
                }
            } catch (error) {
                console.error('Error loading global styles:', error);
                showToast('Fejl ved indl√¶sning af globale stilarter', true);
            } finally {
                hideLoading();
            }
        }
        
        /**
         * Save global styles
         */
        async function saveGlobalStyles() {
            try {
                showLoading();
                
                const colorPalette = {
                    primary: document.getElementById('primaryColor').value,
                    secondary: document.getElementById('secondaryColor').value,
                    accent: document.getElementById('accentColor').value,
                    bright: document.getElementById('brightColor').value,
                    background: document.getElementById('backgroundColor').value,
                    text: document.getElementById('textColor').value
                };
                
                const fontConfig = {
                    heading: {
                        'font-family': document.getElementById('headingFontFamily').value,
                        'font-weight': document.getElementById('headingFontWeight').value
                    },
                    body: {
                        'font-family': document.getElementById('bodyFontFamily').value,
                        'font-weight': document.getElementById('bodyFontWeight').value
                    },
                    price: {
                        'font-family': document.getElementById('priceFontFamily').value,
                        'font-weight': document.getElementById('priceFontWeight').value
                    },
                    button: {
                        'font-family': document.getElementById('buttonFontFamily').value,
                        'font-weight': document.getElementById('buttonFontWeight').value
                    }
                };
                
                const globalStyles = {
                    css: document.getElementById('globalCss').value
                };
                
                const data = {
                    global_styles: globalStyles,
                    font_config: fontConfig,
                    color_palette: colorPalette
                };
                
                const response = await fetch(`${API_URL}/layout/global/styles`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    showToast('Globale stilarter blev gemt');
                } else {
                    showToast(result.message || 'Fejl ved lagring af globale stilarter', true);
                }
            } catch (error) {
                console.error('Error saving global styles:', error);
                showToast('Fejl ved lagring af globale stilarter', true);
            } finally {
                hideLoading();
            }
        }
        
        /**
         * Load layouts
         */
        async function loadLayouts() {
            try {
                showLoading();
                
                const response = await fetch(`${API_URL}/layout`);
                const result = await response.json();
                
                if (result.status === 'success' && result.data) {
                    layouts = result.data;
                    
                    // Update page dropdowns
                    const pageSelect = document.getElementById('pageSelect');
                    
                    // Clear existing options
                    pageSelect.innerHTML = '<option value="">-- V√¶lg side --</option>';
                    
                    // Add layouts to dropdown
                    layouts.forEach(layout => {
                        if (layout.page_id !== 'global') {
                            const option = document.createElement('option');
                            option.value = layout.page_id;
                            option.textContent = layout.page_id;
                            
                            pageSelect.appendChild(option);
                        }
                    });
                }
            } catch (error) {
                console.error('Error loading layouts:', error);
                showToast('Fejl ved indl√¶sning af layouts', true);
            } finally {
                hideLoading();
            }
        }
        
        /**
         * Handle page change
         */
        async function handlePageChange() {
            const selectedPageId = document.getElementById('pageSelect').value;
            
            if (selectedPageId) {
                try {
                    showLoading();
                    
                    const response = await fetch(`${API_URL}/layout/${selectedPageId}`);
                    const result = await response.json();
                    
                    if (result.status === 'success' && result.data) {
                        const layout = result.data;
                        currentPageId = layout.page_id;
                        
                        document.getElementById('currentPageId').value = layout.page_id;
                        document.getElementById('layoutData').value = JSON.stringify(layout.layout_data || {}, null, 2);
                        
                        document.getElementById('pageDetails').style.display = 'block';
                    } else {
                        showToast(result.message || 'Fejl ved indl√¶sning af side', true);
                    }
                } catch (error) {
                    console.error('Error loading page details:', error);
                    showToast('Fejl ved indl√¶sning af side', true);
                } finally {
                    hideLoading();
                }
            } else {
                document.getElementById('pageDetails').style.display = 'none';
            }
        }
        
        /**
         * Create new page
         */
        async function createNewPage() {
            const pageId = document.getElementById('newPageId').value.trim();
            
            if (!pageId) {
                showToast('Indtast et gyldigt side-id', true);
                return;
            }
            
            try {
                showLoading();
                
                const data = {
                    page_id: pageId,
                    layout_data: {}
                };
                
                const response = await fetch(`${API_URL}/layout`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    showToast(`Siden "${pageId}" blev oprettet`);
                    document.getElementById('newPageId').value = '';
                    await loadLayouts();
                    
                    // Select the new page
                    document.getElementById('pageSelect').value = pageId;
                    await handlePageChange();
                } else {
                    showToast(result.message || 'Fejl ved oprettelse af side', true);
                }
            } catch (error) {
                console.error('Error creating page:', error);
                showToast('Fejl ved oprettelse af side', true);
            } finally {
                hideLoading();
            }
        }
        
        /**
         * Update page
         */
        async function updatePage() {
            if (!currentPageId) {
                showToast('Ingen side valgt', true);
                return;
            }
            
            try {
                showLoading();
                
                let layoutData;
                try {
                    layoutData = JSON.parse(document.getElementById('layoutData').value);
                } catch (e) {
                    showToast('Ugyldig JSON i layout data', true);
                    hideLoading();
                    return;
                }
                
                const data = {
                    layout_data: layoutData
                };
                
                const response = await fetch(`${API_URL}/layout/${currentPageId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    showToast(`Siden "${currentPageId}" blev opdateret`);
                } else {
                    showToast(result.message || 'Fejl ved opdatering af side', true);
                }
            } catch (error) {
                console.error('Error updating page:', error);
                showToast('Fejl ved opdatering af side', true);
            } finally {
                hideLoading();
            }
        }
        
        /**
         * Delete page
         */
        async function deletePage() {
            if (!currentPageId) {
                showToast('Ingen side valgt', true);
                return;
            }
            
            if (!confirm(`Er du sikker p√•, at du vil slette siden "${currentPageId}"?`)) {
                return;
            }
            
            try {
                showLoading();
                
                const response = await fetch(`${API_URL}/layout/${currentPageId}`, {
                    method: 'DELETE'
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    showToast(`Siden "${currentPageId}" blev slettet`);
                    document.getElementById('pageDetails').style.display = 'none';
                    currentPageId = null;
                    await loadLayouts();
                } else {
                    showToast(result.message || 'Fejl ved sletning af side', true);
                }
            } catch (error) {
                console.error('Error deleting page:', error);
                showToast('Fejl ved sletning af side', true);
            } finally {
                hideLoading();
            }
        }
        
        /**
         * Load pages for bands management
         */
        async function loadPagesForBands() {
            try {
                showLoading();
                
                const response = await fetch(`${API_URL}/layout`);
                const result = await response.json();
                
                if (result.status === 'success' && result.data) {
                    const pages = result.data;
                    
                    // Update band page dropdown
                    const bandPageSelect = document.getElementById('band-page-select');
                    
                    // Clear existing options
                    bandPageSelect.innerHTML = '<option value="">-- V√¶lg side --</option>';
                    
                    // Add pages to dropdown
                    pages.forEach(page => {
                        if (page.page_id !== 'global') {
                            const option = document.createElement('option');
                            option.value = page.page_id;
                            option.textContent = page.page_id;
                            bandPageSelect.appendChild(option);
                        }
                    });
                    
                    // Check URL for page selection
                    const urlParams = new URLSearchParams(window.location.search);
                    const pageId = urlParams.get('page');
                    
                    if (pageId) {
                        bandPageSelect.value = pageId;
                        loadBandsForPage(pageId);
                    }
                }
            } catch (error) {
                console.error('Error loading pages for bands:', error);
                showToast('Fejl ved indl√¶sning af sider', true);
            } finally {
                hideLoading();
            }
        }
        
        /**
         * Load bands for a specific page
         */
        async function loadBandsForPage(pageId) {
            if (!pageId) {
                document.getElementById('bands-container').style.display = 'none';
                document.getElementById('no-bands-message').style.display = 'none';
                return;
            }
            
            try {
                showLoading();
                
                const response = await fetch(`${API_URL}/bands/${pageId}`);
                const result = await response.json();
                
                // Update URL with page selection
                const url = new URL(window.location);
                url.searchParams.set('page', pageId);
                window.history.pushState({}, '', url);
                
                if (result.status === 'success') {
                    const bands = result.data || [];
                    
                    if (bands.length === 0) {
                        document.getElementById('bands-container').style.display = 'none';
                        document.getElementById('no-bands-message').style.display = 'block';
                    } else {
                        renderBands(bands, pageId);
                        document.getElementById('bands-container').style.display = 'block';
                        document.getElementById('no-bands-message').style.display = 'none';
                    }
                } else {
                    showToast(result.message || 'Fejl ved indl√¶sning af b√•nd', true);
                    document.getElementById('bands-container').style.display = 'none';
                    document.getElementById('no-bands-message').style.display = 'block';
                }
            } catch (error) {
                console.error('Error loading bands:', error);
                showToast('Fejl ved indl√¶sning af b√•nd', true);
                document.getElementById('bands-container').style.display = 'none';
                document.getElementById('no-bands-message').style.display = 'block';
            } finally {
                hideLoading();
            }
        }
        
        /**
         * Render bands list
         */
        function renderBands(bands, pageId) {
            // Clear bands list
            const bandsList = document.getElementById('bands-list');
            bandsList.innerHTML = '';
            
            // Sort bands by order
            bands.sort((a, b) => a.band_order - b.band_order);
            
            // Create HTML for each band
            bands.forEach((band, index) => {
                const bandEl = document.createElement('div');
                bandEl.className = 'band-card';
                bandEl.dataset.bandId = band.band_id;
                
                // Band type icon/image
                let typeIcon = 'üñºÔ∏è';
                if (band.band_type === 'product') {
                    typeIcon = 'üõçÔ∏è';
                } else if (band.band_type === 'html') {
                    typeIcon = 'üìù';
                } else if (band.band_type === 'related_products') {
                    typeIcon = 'üîÑ';
                } else if (band.band_type === 'link') {
                    typeIcon = 'üîó';
                } else if (band.band_type === 'cta') {
                    typeIcon = 'üì¢';
                } else if (band.band_type === 'product_card') {
                    typeIcon = 'üìá';
                } else if (band.band_type === 'product_full') {
                    typeIcon = 'üì¶';
                }
                
                // Band content preview
                let contentPreview = '';
                if (band.band_type === 'slideshow') {
                    const slides = band.band_content.slides || [];
                    contentPreview = `${slides.length} slide(s)`;
                } else if (band.band_type === 'product') {
                    const title = band.band_content.title || 'Uden titel';
                    contentPreview = title;
                } else if (band.band_type === 'html') {
                    contentPreview = 'HTML indhold';
                } else {
                    contentPreview = band.band_type;
                }
                
                // Band HTML
                bandEl.innerHTML = `
                    <div class="band-card-preview">
                        ${typeIcon}
                        <span class="band-card-badge">${band.band_height}x h√∏jde</span>
                    </div>
                    <div class="band-card-body">
                        <h3 class="band-card-title">${band.band_type.charAt(0).toUpperCase() + band.band_type.slice(1)}</h3>
                        <div class="band-card-meta">
                            <div>Position: ${band.band_order}</div>
                            <div>${contentPreview}</div>
                        </div>
                        <div class="band-card-actions">
                            <button class="action-button edit-band-btn" data-band-id="${band.band_id}">Rediger</button>
                            <button class="action-button move-up-btn" data-band-id="${band.band_id}" ${index === 0 ? 'disabled' : ''}>‚Üë</button>
                            <button class="action-button move-down-btn" data-band-id="${band.band_id}" ${index === bands.length - 1 ? 'disabled' : ''}>‚Üì</button>
                            <button class="action-button danger delete-band-btn" data-band-id="${band.band_id}">Slet</button>
                        </div>
                    </div>
                `;
                
                bandsList.appendChild(bandEl);
                
                // Add event listeners to buttons
                const editBtn = bandEl.querySelector('.edit-band-btn');
                const moveUpBtn = bandEl.querySelector('.move-up-btn');
                const moveDownBtn = bandEl.querySelector('.move-down-btn');
                const deleteBtn = bandEl.querySelector('.delete-band-btn');
                
                editBtn.addEventListener('click', () => editBand(band.band_id, pageId));
                moveUpBtn.addEventListener('click', () => moveBand(band.band_id, -1, pageId));
                moveDownBtn.addEventListener('click', () => moveBand(band.band_id, 1, pageId));
                deleteBtn.addEventListener('click', () => deleteBand(band.band_id, pageId));
            });
        }
        
        /**
         * Add new band
         */
        function addNewBand() {
            const selectedPageId = document.getElementById('band-page-select').value;
            
            if (!selectedPageId) {
                showToast('V√¶lg venligst en side f√∏rst', true);
                return;
            }
            
            // Switch to band editor section
            showSection('band-editor');
            
            // Select the menu item
            sidebarMenuItems.forEach(item => item.classList.remove('active'));
            document.querySelector('[data-section="band-editor"]').classList.add('active');
            
            // Set the page in the band editor
            document.getElementById('band-page').value = selectedPageId;
            
            // Trigger band-editor.js initialization
            if (typeof initBandEditor === 'function') {
                initBandEditor();
            }
        }
        
        /**
         * Edit a band
         */
        function editBand(bandId, pageId) {
            // Switch to band editor section
            showSection('band-editor');
            
            // Select the menu item
            sidebarMenuItems.forEach(item => item.classList.remove('active'));
            document.querySelector('[data-section="band-editor"]').classList.add('active');
            
            // Set the page and load the band in the band editor
            document.getElementById('band-page').value = pageId;
            
            // Set URL parameters
            const url = new URL(window.location);
            url.hash = 'band-editor';
            url.searchParams.set('page', pageId);
            url.searchParams.set('id', bandId);
            window.history.pushState({}, '', url);
            
            // Trigger band-editor.js to load the band
            if (typeof loadBandForEditing === 'function') {
                loadBandForEditing(pageId, bandId);
            }
        }
        
        /**
         * Move a band up or down
         */
        async function moveBand(bandId, direction, pageId) {
            try {
                showLoading();
                
                // Get all bands
                const response = await fetch(`${API_URL}/bands/${pageId}`);
                const result = await response.json();
                
                if (result.status !== 'success') {
                    showToast(result.message || 'Fejl ved flytning af b√•nd', true);
                    return;
                }
                
                const bands = result.data || [];
                
                // Find the band and its neighbor
                let bandIndex = -1;
                let band = null;
                
                for (let i = 0; i < bands.length; i++) {
                    if (bands[i].band_id === bandId) {
                        bandIndex = i;
                        band = bands[i];
                        break;
                    }
                }
                
                if (bandIndex === -1 || !band) {
                    showToast('B√•nd ikke fundet', true);
                    return;
                }
                
                const newIndex = bandIndex + direction;
                
                // Check if the new index is valid
                if (newIndex < 0 || newIndex >= bands.length) {
                    return;
                }
                
                const neighborBand = bands[newIndex];
                
                // Swap the order
                const tempOrder = band.band_order;
                band.band_order = neighborBand.band_order;
                neighborBand.band_order = tempOrder;
                
                // Update both bands
                await fetch(`${API_URL}/bands/${pageId}/${band.band_id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ band_order: band.band_order })
                });
                
                await fetch(`${API_URL}/bands/${pageId}/${neighborBand.band_id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ band_order: neighborBand.band_order })
                });
                
                // Reload bands
                await loadBandsForPage(pageId);
                
                showToast('B√•ndets position blev √¶ndret');
            } catch (error) {
                console.error('Error moving band:', error);
                showToast('Fejl ved flytning af b√•nd', true);
            } finally {
                hideLoading();
            }
        }
        
        /**
         * Delete a band
         */
        async function deleteBand(bandId, pageId) {
            if (!confirm('Er du sikker p√•, at du vil slette dette b√•nd?')) {
                return;
            }
            
            try {
                showLoading();
                
                const response = await fetch(`${API_URL}/bands/${pageId}/${bandId}`, {
                    method: 'DELETE'
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    showToast('B√•ndet blev slettet');
                    await loadBandsForPage(pageId);
                } else {
                    showToast(result.message || 'Fejl ved sletning af b√•nd', true);
                }
            } catch (error) {
                console.error('Error deleting band:', error);
                showToast('Fejl ved sletning af b√•nd', true);
            } finally {
                hideLoading();
            }
        }
        
        /**
         * Show loading indicator
         */
        function showLoading() {
            const loading = document.querySelector('.loading');
            if (loading) {
                loading.classList.add('show');
            }
        }
        
        /**
         * Hide loading indicator
         */
        function hideLoading() {
            const loading = document.querySelector('.loading');
            if (loading) {
                loading.classList.remove('show');
            }
        }
        
        /**
         * Show toast notification
         */
        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            if (!toast) return;
            
            toast.textContent = message;
            toast.className = isError ? 'toast error show' : 'toast show';
            
            setTimeout(() => {
                toast.className = toast.className.replace('show', '');
            }, 3000);
        }
    </script>
    <script src="js/admin_integration.js"></script>
</body>
</html>
